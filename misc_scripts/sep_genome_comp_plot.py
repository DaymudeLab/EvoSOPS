import matplotlib.pyplot as plt
import numpy as np
from cmcrameri.cm import batlow
import matplotlib.ticker as tkr     # has classes for tick-locating and -formatting

def numfmt(x, pos): # your custom formatter function: divide by 100.0
    s = '{}'.format(x / 1000.0)
    return s

yfmt = tkr.FuncFormatter(numfmt)    # create your custom formatter function


ga_probs = {'-3': [1, 1, 1, 16, 4, 1, 1, 2, 1, 31, 4, 31, 8, 1, 8, 4, 4, 8, 1, 4, 1, 4, 8, 8], '-2': [1, 1, 2, 31, 31, 63, 8, 4, 4, 8, 4, 31, 8, 1, 16, 31, 4, 8, 8, 8, 8, 2, 1, 4, 31, 250, 125, 250, 500, 16, 8, 1, 4, 4, 8, 63, 125, 31, 8, 4, 4, 16, 4, 125, 63, 1, 31, 31, 250, 8, 8, 1, 250, 63, 63, 1, 4, 4, 63, 1, 4, 16, 1, 250, 63, 8], '-1': [4, 2, 31, 8, 2, 16, 8, 31, 8, 500, 1000, 8, 16, 250, 16, 4, 2, 4, 125, 500, 63, 4, 16, 1000, 8, 63, 2, 31, 2, 1, 8, 2, 63, 31, 1, 63, 16, 8, 16, 16, 31, 8, 16, 63, 500, 63, 8, 16, 63, 8, 63, 250, 63, 250, 500, 2, 8, 31, 8, 31, 63, 125, 31, 125, 4, 1, 125, 4, 125, 500, 63, 250, 8, 125, 2, 500, 8, 2, 1000, 2, 4, 4, 31, 31, 8, 1000, 1000, 500, 63, 8, 31, 4, 8, 1000, 8, 125, 2, 31, 31, 125, 8, 2, 4, 500, 500, 2, 125, 8, 1000, 4, 63, 8, 2, 250, 500, 125, 250, 8, 1000, 4], '0': [500, 500, 16, 63, 4, 4, 2, 1000, 500, 31, 31, 31, 8, 2, 31, 2, 250, 4, 63, 1000, 125, 8, 31, 63, 16, 8, 8, 500, 1000, 8, 2, 125, 16, 4, 2, 16, 4, 125, 31, 63, 4, 1, 8, 63, 16, 125, 1, 250, 125, 31, 2, 63, 1000, 250, 31, 1000, 500, 500, 16, 16, 8, 31, 500, 500, 1000, 250, 63, 31, 16, 1000, 1000, 1000, 1000, 2, 2, 2, 125, 500, 1000, 1000, 1000, 125, 63, 125, 125, 250, 1000, 8, 250, 63, 1, 8, 2, 500, 500, 1, 63, 1000, 500, 1, 31, 31, 250, 1, 8, 2, 16, 63, 4, 2, 125, 500, 2, 125, 31, 16, 16, 16, 250, 16, 1000, 125, 4, 1, 63, 1000, 31, 4, 63, 4, 16, 8, 31, 250, 63, 8, 4, 500, 250, 1000, 1000, 500, 63, 2, 1000, 16, 16, 31, 1000, 1000, 500, 16, 1000, 125, 31, 1, 1, 63, 63, 2, 63, 1000, 1, 1, 500, 250, 2, 1000, 2, 1000, 4, 63, 1000, 1000, 63, 125, 125, 1000, 250, 63], '1': [1000, 500, 125, 2, 31, 500, 63, 4, 250, 500, 500, 63, 1000, 4, 4, 1000, 1000, 63, 1000, 500, 1000, 1000, 4, 4, 1000, 1, 1000, 500, 1000, 16, 63, 250, 250, 1000, 1000, 2, 1000, 1000, 500, 1, 63, 500, 2, 4, 500, 2, 1000, 1000, 4, 500, 4, 500, 1000, 500, 4, 250, 1, 250, 500, 8, 1000, 500, 1000, 250, 1000, 16, 2, 2, 250, 4, 2, 2, 250, 250, 125, 1000, 1, 500, 31, 4, 500, 63, 125, 1, 4, 8, 1000, 63, 250, 500, 500, 8, 16, 125, 16, 1000, 1, 16, 63, 1, 1000, 1, 1000, 125, 250, 125, 31, 250, 31, 1000, 4, 1000, 1000, 1000, 1000, 125, 1000, 500, 250, 16], '2': [500, 8, 16, 1000, 1000, 1000, 125, 500, 1000, 500, 4, 500, 1000, 125, 1000, 1000, 125, 500, 250, 8, 16, 8, 1000, 500, 16, 63, 31, 31, 1000, 63, 1000, 63, 1000, 8, 250, 1000, 1000, 4, 63, 500, 250, 1000, 2, 250, 1, 1, 250, 1000, 4, 1000, 500, 1000, 1000, 1000, 63, 8, 250, 63, 1000, 4, 1000, 1, 500, 16, 250, 250], '3': [2, 125, 1, 500, 1, 1000, 2, 2, 1000, 1000, 1000, 1000, 1000, 1000, 31, 63, 4, 500, 1000, 31, 250, 1000, 1000, 1000]}

th_probs = {'-3': [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16],'-2': [63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10, 63, 10], '-1': [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7, 250, 42, 7], '0': [1000, 1000, 1000, 1000, 1000, 1000, 1000, 167, 1000, 167, 1000, 167, 1000, 167, 1000, 167, 1000, 167, 1000, 167, 1000, 167, 1000, 167, 1000, 167, 1000, 167, 1000, 167, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5, 1000, 167, 28, 5], '1': [1000, 667, 1000, 667, 1000, 667, 1000, 667, 1000, 667, 1000, 667, 1000, 667, 111, 1000, 667, 111, 1000, 667, 111, 1000, 667, 111, 1000, 667, 111, 1000, 667, 111, 1000, 667, 111, 1000, 667, 111, 1000, 667, 111, 1000, 667, 111, 1000, 667, 111, 1000, 667, 111, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19, 1000, 667, 111, 19], '2': [1000, 1000, 444, 1000, 1000, 444, 1000, 1000, 444, 1000, 1000, 444, 1000, 1000, 444, 1000, 1000, 444, 1000, 1000, 444, 74, 1000, 1000, 444, 74, 1000, 1000, 444, 74, 1000, 1000, 444, 74, 1000, 1000, 444, 74, 1000, 1000, 444, 74, 1000, 1000, 444, 74, 1000, 1000, 444, 74, 1000, 1000, 444, 74, 1000, 1000, 444, 74, 1000, 1000, 444, 74, 1000, 1000, 444, 74], '3': [1000, 1000, 1000, 296, 1000, 1000, 1000, 296, 1000, 1000, 1000, 296, 1000, 1000, 1000, 296, 1000, 1000, 1000, 296, 1000, 1000, 1000, 296] }


ga_prob = ga_probs.values()

th_prob = th_probs.values()
# the list named ticks, summarizes or groups
# the summer and winter rainfall as low, mid
# and high
ticks = ga_probs.keys()

# create a boxplot for two arrays separately,
# the position specifies the location of the
# particular box in the graph,
# this can be changed as per your wish. Use width
# to specify the width of the plot
ga_prob_plot = plt.boxplot(ga_prob,positions=np.array(np.arange(len(ga_prob)))*2.0-0.25,widths=0.3, showfliers=False, medianprops={"linewidth": 2.5})
# *2.0-0.35
th_prob_plot = plt.boxplot(th_prob,positions=np.array(np.arange(len(th_prob)))*2.0+0.25, widths=0.3,  showfliers=False, medianprops={"linewidth": 2.5})
# *2.0+0.35
# each plot returns a dictionary, use plt.setp()
# function to assign the color code
# for all properties of the box plot of particular group
# use the below function to set color for particular group,
# by iterating over all properties of the box plot
def define_box_properties(plot_name, color_code, label):
	for k, v in plot_name.items():
		plt.setp(plot_name.get(k), color=color_code)
		
	# use plot function to draw a small line to name the legend.
	plt.plot([], c=color_code, label=label)
	plt.legend()


# setting colors for each groups
define_box_properties(ga_prob_plot, batlow(0.4), 'GA') #'#D7191C'
define_box_properties(th_prob_plot, batlow(0.6), 'Theory') #'#2C7BB6'

# set the x label values
plt.xticks(np.arange(0, len(ticks) * 2, 2), ticks)

# set the limit for x axis
plt.xlim(-2, len(ticks)*2)

# set the limit for y axis
# plt.ylim(-20, 1100)
plt.semilogy(base=2)
plt.gca().yaxis.set_major_formatter(yfmt)

plt.xlabel(r"Change in Total Neighbors $e' - e$") #, color=batlow(0.1))
plt.ylabel('Move Probability') #, color=batlow(0.1))

# set the title
plt.title('Separation Genomic Composition')

plt.savefig('output/Sep_gene_comp.png', dpi=300, bbox_inches='tight')
# plt.show()